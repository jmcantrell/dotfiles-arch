#!/usr/bin/env bash

# Install and configure the Mullvad VPN app.

set -eu

: "$MULLVAD_ACCOUNT" "$MULLVAD_COUNTRY" "$MULLVAD_CITY"

script_file=$(mktemp -t "${0##*/}.XXXXXXXXXX")
trap 'rm -f ${script_file@Q}' INT TERM EXIT

curl -sSL -o "$script_file" https://mullvad.net/media/files/mullvad-wg.sh
chmod +x "$script_file"
"$script_file" <<<"$MULLVAD_ACCOUNT"

sudo systemctl enable --now wg-quick@wg-mullvad.service
