#!/usr/bin/env bash

# Simple AUR package builder and installer.
# Usage: aur-install NAME...

set -eu

temp_dir=$(mktemp -d -t "${0##*/}".XXXXXXXXXX)
trap 'rm -rf "$temp_dir"' INT TERM EXIT

url="https://aur.archlinux.org/cgit/aur.git/snapshot"

for name in "$@"; do
    package=$name.tar.gz

    curl -L -o "$temp_dir/$package" "$url/$package"
    tar -x -f "$temp_dir/$package" -C "$temp_dir"

    cd "$temp_dir/$name"

    makepkg --force --syncdeps --install --noconfirm
done
