#!/usr/bin/env sh

# Configure an arch linux desktop environment.

set -e

enable-system
enable-terminal
enable-dev
enable-xorg
enable-i3
enable-pulseaudio

#enable-media
#enable-studio
#enable-ufw && sudo pacman -S --noconfirm --needed gufw
#enable-office && sudo pacman -S --noconfirm --needed system-config-printer

pacaur -y --noconfirm --needed --noedit rectsel xzoom

pacaur --noconfirm --needed --noedit clipmenu
systemctl --user --now enable clipmenud.service

# check for available sound devices
if test "`pactl list short sinks | wc -l`" -eq 0; then
    # volume status and control tray icon
    sudo pacman -S --noconfirm --needed volumeicon
    # will start on next login, but start now
    dex ~/.config/autostart/volumeicon.desktop &
fi

# check for available batteries
if has xinit && test "`acpi -b | wc -l`" -eq 0; then
    # battery status notification tray icon
    sudo pacman -Sy --noconfirm --needed cbatticon
    # will start on next login, but start now
    dex ~/.config/autostart/cbatticon.desktop &
fi

# removable disk auto mounter and tray icon
sudo pacman -Sy --noconfirm --needed udiskie
# access to removable disks relative to home directory
ln -svfT "/run/media/$USER" "$HOME/.local/media"
# will start on next login, but start now
dex ~/.config/autostart/udiskie.desktop &

sudo pacman -S --noconfirm --needed \
    firefox feh vlc mplayer gifsicle mupdf gparted
