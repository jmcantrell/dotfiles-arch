#!/usr/bin/env bash

set -eu

name=${1:-}

pacman_list=$PWD/packages/pacman${name:+-$name}
aur_list=$PWD/packages/aur${name:+-$name}

if [[ -f $pacman_list ]]; then
    sudo pacman --sync --noconfirm --needed - <"$pacman_list"
fi

if [[ -f $aur_list ]]; then
    if [[ ! -x /usr/bin/pikaur ]]; then
        ./stow/.local/bin/aur-install pikaur
    fi
    pikaur --sync --noconfirm --needed - <"$aur_list"
fi
